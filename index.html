<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>Vivian's MS Graph API Reference</title>

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight, .highlight .w {
  color: #f8f8f2;
  background-color: #272822;
}
.highlight .err {
  color: #272822;
  background-color: #f92672;
}
.highlight .c, .highlight .cd, .highlight .cm, .highlight .c1, .highlight .cs {
  color: #75715e;
}
.highlight .cp {
  color: #f4bf75;
}
.highlight .nt {
  color: #f4bf75;
}
.highlight .o, .highlight .ow {
  color: #f8f8f2;
}
.highlight .p, .highlight .pi {
  color: #f8f8f2;
}
.highlight .gi {
  color: #a6e22e;
}
.highlight .gd {
  color: #f92672;
}
.highlight .gh {
  color: #66d9ef;
  background-color: #272822;
  font-weight: bold;
}
.highlight .k, .highlight .kn, .highlight .kp, .highlight .kr, .highlight .kv {
  color: #ae81ff;
}
.highlight .kc {
  color: #fd971f;
}
.highlight .kt {
  color: #fd971f;
}
.highlight .kd {
  color: #fd971f;
}
.highlight .s, .highlight .sb, .highlight .sc, .highlight .sd, .highlight .s2, .highlight .sh, .highlight .sx, .highlight .s1 {
  color: #a6e22e;
}
.highlight .sr {
  color: #a1efe4;
}
.highlight .si {
  color: #cc6633;
}
.highlight .se {
  color: #cc6633;
}
.highlight .nn {
  color: #f4bf75;
}
.highlight .nc {
  color: #f4bf75;
}
.highlight .no {
  color: #f4bf75;
}
.highlight .na {
  color: #66d9ef;
}
.highlight .m, .highlight .mf, .highlight .mh, .highlight .mi, .highlight .il, .highlight .mo, .highlight .mb, .highlight .mx {
  color: #a6e22e;
}
.highlight .ss {
  color: #a6e22e;
}
    </style>
    <link href="stylesheets/screen.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" media="print" />
      <script src="javascripts/all.js"></script>
  </head>

  <body class="index" data-languages="[&quot;http&quot;,&quot;ruby&quot;,&quot;python&quot;,&quot;javascript&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" alt="Navbar" />
      </span>
    </a>
    <div class="tocify-wrapper">
      <img src="images/logo.png" alt="Logo" />
        <div class="lang-selector">
              <a href="#" data-language-name="http">http</a>
              <a href="#" data-language-name="ruby">ruby</a>
              <a href="#" data-language-name="python">python</a>
              <a href="#" data-language-name="javascript">javascript</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <div id="toc">
      </div>
        <ul class="toc-footer">
            <li><a href='#'>Sign Up for a Developer Key</a></li>
            <li><a href='https://github.com/tripit/slate'>Documentation Powered by Slate</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id="overview-of-microsoft-graph">Overview of Microsoft Graph</h1>

<blockquote>
<p>API endpoint</p>
</blockquote>
<pre class="highlight http"><code><span class="nf">GET</span> <span class="nn">https://graph.microsoft.com/v1.0</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
</code></pre>
<p>Microsoft Graph API is a RESTful interface that is used to interact with data in the Microsoft cloud. You can use Microsoft Graph in your applications to read, write, and traverse your users&rsquo; data through a single endpoint. Here&rsquo;s is what the Graph is made of:</p>

<p><strong>Nodes</strong> are the objects you interact with, like users, groups, mail, calendar, files. Each node contains information about that node like <em>displayName</em> and <em>id</em>, stored as properties.</p>

<p><strong>Edges</strong> are the connections between the nodes, like <em>isMemberOf</em> between a user and a group, and <em>isOwnerOf</em> between a user and a file.</p>

<p><img src="images/microsoft-graph_hero-image.png" alt="Graph visualization that is slightly too complex." /></p>

<p>In this overview, you will learn how to send a mail and browse your drive using Microsoft Graph through the Graph Explorer.</p>

<h2 id="introducing-the-graph-explorer">Introducing the Graph Explorer</h2>

<p>The Graph Explorer is a simple way to get started with Microsoft Graph. Simply put, this is just a web app built on top of Microsoft Graph that takes in your HTTP requests and returns live responses right through the browser. All you have to do is sign in, and it will handle all the token exchanges to make your requests work.</p>

<p>To learn more about obtaining and using tokens, go to <strong>Managing your access token through REST</strong></p>

<h3 id="api-versioning">API Versioning</h3>

<p>In Graph Explorer, you will choose which version of Microsoft Graph you will use.
- v1.0 is the production ready tier of Graph. We promise no breaking changes as more features are added.
- beta is the experimental tier of Graph. Features will be added here and then pushed to a production ready tier or otherwise removed. It is recommended you don&rsquo;t write production code against beta.</p>

<h2 id="send-a-mail">Send a mail</h2>

<p>Sign into Graph Explorer using your Microsoft account (Outlook, Live, Hotmail) or Office365 account <strong>if you are an administrator (because they have to consent to Graph Explorer).</strong> Select v1.0 and POST from the dropdowns, and enter the following request and body.</p>

<p><img src="images/graph_explorer_sendmail.png" alt="Graph Explorer screenshot for sending mail." /></p>

<p>Hit Go.</p>

<blockquote>
<p>NOTE THIS MESSAGE WAS MARKED AS SPAM IN GMAIL. NEED TO FIGURE OUT WHY.</p>
</blockquote>
<pre class="highlight http"><code><span class="nf">POST</span> <span class="nn">https://graph.microsoft.com/v1.0/me/sendMail</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="s">{</span>
<span class="s">  "Message": {</span>
<span class="s">    "subject": "My second mail",</span>
<span class="s">    "body": {</span>
<span class="s">      "contentType": "text",</span>
<span class="s">      "content": "Hello world again!"</span>
<span class="s">    },</span>
<span class="s">    "bodyPreview": "hello!",</span>
<span class="s">    "toRecipients": [</span>
<span class="s">      {</span>
<span class="s">        "emailAddress": {</span>
<span class="s">          "name": "Vivian",</span>
<span class="s">          "address": "viv.liu25@gmail.com"</span>
<span class="s">        }</span>
<span class="s">      }</span>
<span class="s">    ]</span>
<span class="s">  }</span>
<span class="s">}</span>
</code></pre>
<p>Congrats, you just sent your first mail using Microsoft Graph!</p>

<p>The response contains an HTTP status code to tell you the success or failure state of your request. To learn more about error codes and some of the causes, visit <strong>Errors</strong>.</p>

<p>MVP for setting up a tenant/MSA?
What works for MSA &ldquo;tenant&rdquo; vs AAD tenant?  </p>

<h2 id="browse-your-drive">Browse your drive</h2>

<p>Make sure you are signed into Graph Explorer.
Select v1.0 and GET from the dropdowns, and enter the following request URL.</p>

<p>Hit Go.</p>
<pre class="highlight http"><code><span class="nf">GET</span> <span class="nn">https://graph.microsoft.com/v1.0/drives</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
</code></pre>
<p>This lets you see the OneDrive documents you have under this account. You can create a new folder, navigate through folders, and download files through <strong>a OneDrive tutorial</strong>.</p>

<h1 id="use-the-api-better">Use the API better</h1>

<h2 id="accessing-user-data">Accessing user data</h2>

<h2 id="paging">Paging</h2>

<h2 id="batching-not-yet-available">Batching (not yet available)</h2>

<h2 id="errors">Errors</h2>

<h2 id="debugging">Debugging</h2>

<h2 id="customize-query">Customize query</h2>

<h1 id="tutorials">Tutorials</h1>

<p>On this page we will cover the most basic scenarios that require a one-line code snippet. More advanced scenarios can be found in the sub categories.</p>

<h3 id="get-my-inbox">Get my inbox</h3>

<blockquote>
<p>http code</p>

<h3 id="get-my-drive">Get my drive</h3>

<p>http code</p>

<h3 id="who-is-my-manager">Who is my manager</h3>

<p>http code</p>

<h3 id="download-a-file-from-drive">Download a file from drive</h3>

<p>http code</p>
</blockquote>

<h2 id="send-user-push-notifications">Send user push notifications</h2>

<h2 id="get-mail-changes-since-last-query">Get mail changes since last query</h2>

<h2 id="attach-a-file-to-mail">Attach a file to mail</h2>

<h2 id="find-closest-contacts">Find closest contacts</h2>

<h2 id="create-an-excel-spreadsheet">Create an Excel spreadsheet</h2>

<h1 id="deep-drives-concepts">Deep drives/Concepts</h1>

<h2 id="delta-query">Delta query</h2>

<h2 id="sovereign-deployments">Sovereign Deployments</h2>

<h2 id="hybrid-deployments">Hybrid Deployments</h2>

<h2 id="onedrive-architecture">OneDrive Architecture</h2>

<h1 id="reference">Reference</h1>

<h2 id="users">Users</h2>

<h2 id="outlook">Outlook</h2>

<h2 id="onedrive">OneDrive</h2>

<h2 id="directory">Directory</h2>

<h2 id="and-much-much-more">And much much more</h2>

<h1 id="beta-reference">Beta Reference</h1>

<blockquote>
<p>API endpoint</p>
</blockquote>
<pre class="highlight http"><code><span class="nf">GET</span> <span class="nn">https://graph.microsoft.com/beta</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
</code></pre>
<p>Beta is the experimental tier of Graph. You can try out features here that are experimental, and provide us with feedback so that we can push to a production ready tier such as v1.0 or a future v2.0 or otherwise remove it. It is recommended you don&rsquo;t write production code against beta.</p>

<h2 id="users">Users</h2>

<h2 id="outlook">Outlook</h2>

<h2 id="onedrive">OneDrive</h2>

<h2 id="directory">Directory</h2>

<h2 id="kittens">Kittens</h2>

<h3 id="get-all-kittens">Get All Kittens</h3>
<pre class="highlight ruby"><code><span class="nb">require</span> <span class="s1">'kittn'</span>

<span class="n">api</span> <span class="o">=</span> <span class="no">Kittn</span><span class="o">::</span><span class="no">APIClient</span><span class="p">.</span><span class="nf">authorize!</span><span class="p">(</span><span class="s1">'meowmeowmeow'</span><span class="p">)</span>
<span class="n">api</span><span class="p">.</span><span class="nf">kittens</span><span class="p">.</span><span class="nf">get</span>
</code></pre><pre class="highlight python"><code><span class="kn">import</span> <span class="nn">kittn</span>

<span class="n">api</span> <span class="o">=</span> <span class="n">kittn</span><span class="o">.</span><span class="n">authorize</span><span class="p">(</span><span class="s">'meowmeowmeow'</span><span class="p">)</span>
<span class="n">api</span><span class="o">.</span><span class="n">kittens</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
</code></pre><pre class="highlight shell"><code>curl <span class="s2">"http://example.com/api/kittens"</span>
  -H <span class="s2">"Authorization: meowmeowmeow"</span>
</code></pre><pre class="highlight javascript"><code><span class="kr">const</span> <span class="nx">kittn</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'kittn'</span><span class="p">);</span>

<span class="kd">let</span> <span class="nx">api</span> <span class="o">=</span> <span class="nx">kittn</span><span class="p">.</span><span class="nx">authorize</span><span class="p">(</span><span class="s1">'meowmeowmeow'</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">kittens</span> <span class="o">=</span> <span class="nx">api</span><span class="p">.</span><span class="nx">kittens</span><span class="p">.</span><span class="nx">get</span><span class="p">();</span>
</code></pre>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Fluffums"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"breed"</span><span class="p">:</span><span class="w"> </span><span class="s2">"calico"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"fluffiness"</span><span class="p">:</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w">
    </span><span class="nt">"cuteness"</span><span class="p">:</span><span class="w"> </span><span class="mi">7</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Max"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"breed"</span><span class="p">:</span><span class="w"> </span><span class="s2">"unknown"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"fluffiness"</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w">
    </span><span class="nt">"cuteness"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre>
<p>This endpoint retrieves all kittens.</p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">GET http://example.com/api/kittens</code></p>

<h3 id="query-parameters">Query Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>include_cats</td>
<td>false</td>
<td>If set to true, the result will also include cats.</td>
</tr>
<tr>
<td>available</td>
<td>true</td>
<td>If set to false, the result will include kittens that have already been adopted.</td>
</tr>
</tbody></table>

<aside class="success">
Remember — a happy kitten is an authenticated kitten!
</aside>

<h3 id="get-a-specific-kitten">Get a Specific Kitten</h3>
<pre class="highlight ruby"><code><span class="nb">require</span> <span class="s1">'kittn'</span>

<span class="n">api</span> <span class="o">=</span> <span class="no">Kittn</span><span class="o">::</span><span class="no">APIClient</span><span class="p">.</span><span class="nf">authorize!</span><span class="p">(</span><span class="s1">'meowmeowmeow'</span><span class="p">)</span>
<span class="n">api</span><span class="p">.</span><span class="nf">kittens</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</code></pre><pre class="highlight python"><code><span class="kn">import</span> <span class="nn">kittn</span>

<span class="n">api</span> <span class="o">=</span> <span class="n">kittn</span><span class="o">.</span><span class="n">authorize</span><span class="p">(</span><span class="s">'meowmeowmeow'</span><span class="p">)</span>
<span class="n">api</span><span class="o">.</span><span class="n">kittens</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</code></pre><pre class="highlight shell"><code>curl <span class="s2">"http://example.com/api/kittens/2"</span>
  -H <span class="s2">"Authorization: meowmeowmeow"</span>
</code></pre><pre class="highlight javascript"><code><span class="kr">const</span> <span class="nx">kittn</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'kittn'</span><span class="p">);</span>

<span class="kd">let</span> <span class="nx">api</span> <span class="o">=</span> <span class="nx">kittn</span><span class="p">.</span><span class="nx">authorize</span><span class="p">(</span><span class="s1">'meowmeowmeow'</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">max</span> <span class="o">=</span> <span class="nx">api</span><span class="p">.</span><span class="nx">kittens</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
</code></pre>
<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
  </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Max"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"breed"</span><span class="p">:</span><span class="w"> </span><span class="s2">"unknown"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"fluffiness"</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w">
  </span><span class="nt">"cuteness"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>This endpoint retrieves a specific kitten.</p>

<aside class="warning">Inside HTML code blocks like this one, you can&rsquo;t use Markdown, so use <code>&lt;code&gt;</code> blocks to denote code.</aside>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">GET http://example.com/kittens/&lt;ID&gt;</code></p>

<h3 id="url-parameters">URL Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>ID</td>
<td>The ID of the kitten to retrieve</td>
</tr>
</tbody></table>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="http">http</a>
                <a href="#" data-language-name="ruby">ruby</a>
                <a href="#" data-language-name="python">python</a>
                <a href="#" data-language-name="javascript">javascript</a>
          </div>
      </div>
    </div>
  </body>
</html>
